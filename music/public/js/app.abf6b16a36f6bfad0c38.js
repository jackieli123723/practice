webpackJsonp([1],{35:function(t,i,s){"use strict";function e(t){if(t){var i=o()({},c,t),s=new XMLHttpRequest;if(s.open(i.method,e.proxyHead+i.url,i.sync),i.head)for(var n in i.head){if(!i.head.hasOwnProperty(n))break;s.setRequestHeader(n,i.head[n])}var r="";if("post"===i.method.toLowerCase()&&i.data)for(var u in i.data)r&&(r+="&"),r+=u+"="+i.data[u];s.send(r);new a.a(function(t,e){s.onreadystatechange=function(i){4===s.readyState&&200===s.status&&t(JSON.parse(s.responseText))},setTimeout(function(){e("too late")},i.loadTime)}).then(function(t){i.success&&i.success.call(i.ctx,t)},function(t){options.fail&&i.fail(t)})}}i.a=e;var n=s(45),a=s.n(n),r=s(44),o=s.n(r),c={method:"get",url:"",head:null,data:null,success:null,fail:null,loadTime:1e4,sync:!0,ctx:null};e.proxyHead=""},36:function(t,i,s){function e(t){s(82)}var n=s(7)(s(38),s(91),e,null,null);t.exports=n.exports},38:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=s(89),n=s.n(e),a=s(88),r=s.n(a),o=s(86),c=s.n(o),u=s(87),l=s.n(u);i.default={name:"app",created:function(){var t=this;this.logOn(),this.createAudio(),this.$nextTick(function(){t.$el.addEventListener("click",function(i){-1===i.target.className.indexOf("header-music-list")&&(t.showClassify=!1),-1===i.target.className.indexOf("header-play-list")&&(t.showPlayList=!1)})})},data:function(){return{showLoginPanel:!1,loginMessage:"login",loginData:{username:""},isLogin:!1,isAdmin:!1,showSpaner:!1,showClassify:!1,playList:[],currentMusic:0,showPlayList:!1,showLyric:!1}},methods:{createAudio:function(){var t=document.createElement("audio");t.setAttribute("autoplay",""),t.setAttribute("id","audio"),document.body.appendChild(t)},logOn:function(){var t=this;this.$http({method:"get",url:"/main/userInfo",success:function(i){i.isLogged&&(t.loginData.username=i.username,t.isLogin=!0,t.isAdmin=i.isAdmin)},fail:function(t){console.log(t),console.log("login false")}})},toLogin:function(){this.loginMessage="login",this.showLoginPanel=!0},toRegister:function(){this.loginMessage="register",this.showLoginPanel=!0},getLoginData:function(t){this.isLogin=!0,this.loginData=t},logout:function(){this.$http({method:"get",url:"/api/user/logout",success:function(t){t.code||window.location.reload()},fail:function(t){console.log(t),console.log("logout false")}})},pushId:function(t){for(var i=0;i<this.playList.length;i++)if(this.playList[i].id===t.id)return void(this.currentMusic=i);this.playList.unshift(t),this.currentMusic=0},pushItem:function(t){for(var i=0;i<this.playList.length;i++)if(this.playList[i].id===t.id)return;this.playList.push(t)},prevMusic:function(){this.playList.length<1||--this.currentMusic<0&&(this.currentMusic+=this.playList.length)},nextMusic:function(){this.playList.length<1||++this.currentMusic>=this.playList.length&&(this.currentMusic=this.playList.length%this.currentMusic)},clearPlayList:function(){this.playList=[],this.currentMusic=0},switchMusic:function(t){this.currentMusic=t},delItem:function(t){this.playList.splice(t,1)},toggleLyric:function(){this.showLyric=!this.showLyric}},components:{Container:n.a,MusicPanel:r.a,Login:c.a,Lyric:l.a}}},39:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={name:"login",props:["todo"],created:function(){},data:function(){return{loginData:{username:"",password:""},registerData:{username:"",password:"",confirmPassword:""}}},methods:{validator:function(){""===this.loginData.username||""===this.loginData.password?alert("用户名和密码不能为空"):this.$http({method:"post",url:"/api/user/login",head:{"Content-type":"application/x-www-form-urlencoded",withCredentials:!0},data:{username:this.loginData.username,password:this.loginData.password},success:function(t){if(t.code)return void alert(t.message);alert(t.message),window.location.reload()},fail:function(t){console.log(t),console.log("false")}})},registerValidator:function(){""===this.registerData.username||""===this.registerData.password||""===this.registerData.confirmPassword?alert("用户名和密码不能为空"):this.registerData.password!==this.registerData.confirmPassword?alert("两次密码输入不一致"):this.$http({method:"post",url:"/api/user/register",head:{"Content-type":"application/x-www-form-urlencoded"},data:{username:this.registerData.username,password:this.registerData.password,repassword:this.registerData.confirmPassword},success:function(t){var i=this;if(t.code)return void alert(t.message);setTimeout(function(){alert("注册成功"),i.todo="login"})},fail:function(t){console.log(t),console.log("false")}})},hidePanel:function(t){t.target===this.$el&&this.$emit("hide")}}}},40:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=void 0,n=void 0,a=void 0;i.default={name:"Lyric",props:["current"],created:function(){var t=this;this.$nextTick(function(){t.bindWatch(),t.getLyric()})},data:function(){return{lyric:[],currentTime:0,currentLine:0}},methods:{bindWatch:function(){e||(e=document.getElementById("audio")),this.$watch("current",function(){this.currentTime=0,this.currentLine=0,this.current&&(e||(e=document.getElementById("audio")),this.getLyric())}),this.$watch("currentLine",function(t,i){this.switchLine()})},getLyric:function(){this.$http({url:"/lyric?id="+this.current.id,success:function(t){this.lyric=[],this.resetLyric(t)},fail:function(){console.log("false")},ctx:this})},switchLine:function(){a||(a=this.$el.querySelector(".lyric-wrap")),a.style.top=2*-this.currentLine+"em"},resetLyric:function(t){if(!t.nolyric){var i=t.lrc.lyric.split("\n"),s=/\[\d*:\d*.\d*\]/g,e=[];i.forEach(function(t){var i=t.match(s);if(!i){var n=t.match(/\[ti:(.*?)\]/);if(n)return void(e.ti=n[1]);var a=t.match(/\[ar:(.*?)\]/);return void(a&&(e.ar=a[1]))}i=i[0];var r=i.match(/\[(\d*)/)[1]-0,o=i.match(/\:(\d*)./)[1]-0;e.push({time:60*r+o,lyric:t.replace(s,"")})}),this.lyric=e,this.setInterval()}},setInterval:function(t){function i(){return t.apply(this,arguments)}return i.toString=function(){return t.toString()},i}(function(){var t=this;clearInterval(n),this.lyric&&e&&(n=setInterval(function(){var i=t.lyric,s=void 0;for(t.currentTime=e.currentTime,s=i.length;--s>=0;)if(i[s].time<t.currentTime){t.currentLine=s;break}s||(t.currentLine=0)},200))})}}},41:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=null,n=null;i.default={name:"MusicPanel",props:["current"],created:function(){var t=this;this.$nextTick(function(){t.bingWatcher()})},data:function(){return{currentUrl:"",isPause:!1,picSrc:"",currentTime:"00:00",duration:"00:00",currentPercentage:0,musicBar:null}},methods:{bingWatcher:function(){var t=this;this.$watch("current",function(i){if(!this.current)return clearInterval(n),void e.pause();t.loadMusic(),t.loadPic()}),this.$watch("currentPercentage",function(t){if(this.current)return t>=100?void this.next():void(this.$el.querySelector(".play-btn").style.width=t+"%")})},loadMusic:function(){e||this.getAudio(),("number"!=typeof m||isNaN(-m))&&this.$http({method:"get",url:"/music/url?id="+this.current.id,success:function(t){this.currentUrl=t.data[0].url,e.src=this.currentUrl,this.setInterval()},fail:function(){console.log("false")},ctx:this})},setInterval:function(t){function i(){return t.apply(this,arguments)}return i.toString=function(){return t.toString()},i}(function(){var t=this;clearInterval(n),n=setInterval(function(){t.duration=t.getTime(Math.floor(e.duration)),t.currentTime=t.getTime(Math.floor(e.currentTime)),t.currentPercentage=e.currentTime/e.duration*100},200)}),getTime:function(t){if("number"!=typeof t||isNaN(-t))return"00:00";var i=Math.floor(t/60);i<10&&(i="0"+i);var t=t%60;return t<10&&(t="0"+t),i+":"+t},pauseMusic:function(){this.isPause=!this.isPause,this.isPause?e.pause():e.play()},getAudio:function(){e=document.getElementById("audio")},loadPic:function(){this.picSrc=this.current.al.picUrl},prev:function(){this.$emit("prev")},next:function(){this.$emit("next")},switchProgress:function(t){if(this.musicBar||(this.musicBar=this.$el.querySelector(".music-play")),this.current){var i=this.musicBar.getBoundingClientRect();e.currentTime=Math.floor((t.pageX-i.left)/i.width*e.duration)}},showLyric:function(){this.$emit("showLyric")}}}},42:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={name:"container",created:function(){this.getTypeList()},props:["showClassify"],data:function(){return{singerList:[],musicData:[],nowActive:0,isLogin:!1,isAdmin:!1,now:0,typeList:[],list:[],showLyric:!1}},methods:{renderMusicList:function(){this.musicData[this.now]||this.getMusicList()},getMusicList:function(){var t=this.now;this.$http({url:"/playlist/detail?id="+this.typeList.playlists[this.now].id,success:function(i){this.musicData[t]={names:i.playlist.tracks,ids:i.playlist.trackIds},this.musicData=this.musicData.slice()},fail:function(){console.log("false")},ctx:this})},getTypeList:function(){this.$http({url:"/top/playlist/highquality?limit=10",success:function(t){this.typeList=t,this.renderMusicList()},fail:function(){console.log("false")},ctx:this})},changeCurrentList:function(t){this.now=t,this.getMusicList()},saveMusicId:function(t){this.$emit("playMusic",t)},pushItem:function(t){this.$emit("pushItem",t)}}}},43:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=s(37),n=s(36),a=s.n(n),r=s(35);e.a.config.productionTip=!1,e.a.prototype.$http=r.a,new e.a({el:"#app",template:"<App/>",components:{App:a.a}})},81:function(t,i){},82:function(t,i){},83:function(t,i){},84:function(t,i){},85:function(t,i){},86:function(t,i,s){function e(t){s(85)}var n=s(7)(s(39),s(94),e,"data-v-b49f83e0",null);t.exports=n.exports},87:function(t,i,s){function e(t){s(81)}var n=s(7)(s(40),s(90),e,"data-v-0c74eff4",null);t.exports=n.exports},88:function(t,i,s){function e(t){s(84)}var n=s(7)(s(41),s(93),e,"data-v-658aeec8",null);t.exports=n.exports},89:function(t,i,s){function e(t){s(83)}var n=s(7)(s(42),s(92),e,"data-v-5f2b3fc8",null);t.exports=n.exports},90:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{attrs:{id:"Lyric"}},[t.lyric.length?s("div",{staticClass:"lyric-items"},[s("div",{staticClass:"wrap-side"},[s("div",{staticClass:"lyric-wrap"},[t.lyric.ti?s("div",{staticClass:"ti"},[t._v(t._s(t.lyric.ti))]):t._e(),t._v(" "),t.lyric.ar?s("div",{staticClass:"ar"},[t._v(t._s(t.lyric.ar))]):t._e(),t._v(" "),t._l(t.lyric,function(i,e){return s("div",{class:{on:e===t.currentLine,blank:!i.lyric.length}},[t._v("\n          "+t._s(i.lyric)+"\n        ")])})],2)])]):s("div",{staticClass:"lyric-items"},[t._v("暂无歌词")]),t._v(" "),s("img",{staticClass:"img",attrs:{src:t.current.al.picUrl}})])},staticRenderFns:[]}},91:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{attrs:{id:"app"}},[s("header",{staticClass:"header"},[s("div",{staticClass:"logo"},[t._v("我的音乐")]),t._v(" "),t.showLyric?t._e():s("div",{staticClass:"header-music-list",on:{click:function(i){t.showClassify=!0}}},[t._v("分类列表")]),t._v(" "),s("div",{staticClass:"header-play-list",on:{click:function(i){t.showPlayList=!0}}},[t._v("播放列表")]),t._v(" "),t.isLogin?t._e():s("div",{staticClass:"login-box"},[s("span",{on:{click:function(i){t.toLogin()}}},[t._v("登录")]),t._v(" "),s("span",[t._v("/")]),t._v(" "),s("span",{on:{click:function(i){t.toRegister()}}},[t._v("注册")])]),t._v(" "),t.isLogin?s("div",{staticClass:"login-box",on:{mouseover:function(i){t.showSpaner=!0},mouseleave:function(i){t.showSpaner=!1}}},[s("span",[t._v("你好  ")]),t._v(" "),s("span",[t._v(" "+t._s(t.loginData.username))]),t._v(" "),t.isAdmin?s("span",[t._v("/")]):t._e(),t._v(" "),s("span",{on:{click:function(i){t.logout()}}},[t._v("退出")]),t._v(" "),t.showSpaner?s("div",{staticClass:"spinner"},[s("li",[t._v("上传")]),t._v(" "),t.isAdmin?s("li",[t._v("审核")]):t._e(),t._v(" "),t.isAdmin?s("li",[t._v("管理")]):t._e()]):t._e()]):t._e()]),t._v(" "),s("keep-alive",[t.showLyric?t._e():s("container",{attrs:{showClassify:t.showClassify},on:{playMusic:t.pushId,pushItem:t.pushItem}})],1),t._v(" "),s("keep-alive",[t.showLyric?s("Lyric",{attrs:{current:t.playList[t.currentMusic]}}):t._e()],1),t._v(" "),s("MusicPanel",{attrs:{current:t.playList[t.currentMusic]},on:{prev:t.prevMusic,next:t.nextMusic,showLyric:t.toggleLyric}}),t._v(" "),t.showLoginPanel?s("Login",{attrs:{todo:t.loginMessage},on:{hide:function(i){t.showLoginPanel=!1},loginSuccess:t.getLoginData}}):t._e(),t._v(" "),s("div",{staticClass:"playList",class:{show:t.showPlayList}},[s("div",{staticClass:"listhd"},[t._v("播放列表("+t._s(t.playList.length)+")\n      "),s("span",{staticClass:"clear",attrs:{title:"清空"},on:{click:t.clearPlayList}},[t._v("清空")])]),t._v(" "),t._l(t.playList,function(i,e){return s("div",{staticClass:"playList-item"},[s("span",{staticClass:"wrap"},[s("span",{attrs:{title:"移除"},on:{click:t.delItem}},[t._v("×")]),t._v(" "),e===t.currentMusic?s("span",{staticClass:"currentPlay"},[t._v("▶")]):t._e()]),t._v(" "),s("span",{staticClass:"details",on:{click:function(i){t.switchMusic(e)}}},[s("span",[t._v(t._s(i.name))]),t._v(" "),s("span",[t._v(t._s(i.ar[0].name))])])])})],2)],1)},staticRenderFns:[]}},92:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{attrs:{id:"container"}},[s("nav",{staticClass:"classify-list",class:{entered:t.showClassify}},t._l(t.typeList.playlists,function(i,e){return s("div",{staticClass:"classify-item",class:{select:e===t.now},on:{click:function(i){t.changeCurrentList(e)}}},[t._v(t._s(i.name))])})),t._v(" "),s("nav",{staticClass:"music-list"},[t._m(0),t._v(" "),t.musicData[t.now]?s("div",{staticClass:"music-list-items"},t._l(t.musicData[t.now].names,function(i,e){return s("div",{staticClass:"music-list-item"},[s("span",[t._v(t._s(e+1))]),t._v(" \n        "),s("span",{on:{click:function(s){t.saveMusicId(i)}}},[t._v(t._s(i.name))]),t._v(" \n        "),s("span",[t._v(t._s(i.ar[0].name))]),t._v(" \n        "),s("span",[s("span",{attrs:{title:"加入播放列表"},on:{click:function(s){t.pushItem(i)}}},[t._v("+")])])])})):t._e()])])},staticRenderFns:[function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"list-head"},[s("span"),t._v(" \n      "),s("span",[t._v("歌曲")]),t._v(" \n      "),s("span",[t._v("歌手")]),t._v(" \n      "),s("span",[t._v("操作")])])}]}},93:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return t.current?s("div",{attrs:{id:"MusicPanel"}},[s("div",{staticClass:"wrap"},[s("div",{staticClass:"btns"},[s("span",{staticClass:"last",on:{click:t.prev}}),t._v(" "),s("span",{class:{play:t.isPause,stop:!t.isPause},on:{click:function(i){t.pauseMusic()}}}),t._v(" "),s("span",{staticClass:"next",on:{click:t.next}})]),t._v(" "),s("div",{staticClass:"pic"},[s("img",{attrs:{src:t.picSrc},on:{click:t.showLyric}})]),t._v(" "),s("div",{staticClass:"progress"},[s("div",{staticClass:"music-word"},[t._v(t._s(t.current.name)+" "+t._s(t.current.ar[0].name))]),t._v(" "),s("div",{staticClass:"music-play",on:{click:function(i){t.switchProgress(i)}}},[t._m(0)])]),t._v(" "),s("div",{staticClass:"progress-num"},[s("span",[t._v(t._s(t.currentTime))]),t._v(" "),s("span",[t._v("/")]),t._v(" "),s("span",[t._v(t._s(t.duration))])])]),t._v(" "),s("div",{staticClass:"lyric-btn"},[t.current?s("img",{staticClass:"btn-pic",attrs:{src:t.picSrc},on:{click:t.showLyric}}):t._e()])]):t._e()},staticRenderFns:[function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"play-btn"},[s("span",{staticClass:"now"})])}]}},94:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{attrs:{id:"login"},on:{click:function(i){t.hidePanel(i)}}},[s("div",{staticClass:"login-panel"},["login"===t.todo?s("div",[t._m(0),t._v(" "),s("form",{staticClass:"login-form"},[t._v("\n        用户名:"),s("br"),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.loginData.username,expression:"loginData.username"}],attrs:{type:"text",id:"user",name:"username"},domProps:{value:t.loginData.username},on:{input:function(i){i.target.composing||(t.loginData.username=i.target.value)}}}),s("br"),t._v("\n        密码:"),s("br"),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.loginData.password,expression:"loginData.password"}],attrs:{type:"password",id:"psd",name:"password"},domProps:{value:t.loginData.password},on:{input:function(i){i.target.composing||(t.loginData.password=i.target.value)}}}),s("br"),t._v(" "),s("input",{attrs:{type:"button",id:"submit",value:"登录"},on:{click:function(i){t.validator()}}}),t._v(" "),s("input",{attrs:{type:"button",id:"register",value:"去注册"},on:{click:function(i){t.todo="register"}}})])]):s("div",[s("div",{staticClass:"title"},[s("h4",[t._v("注册")])]),t._v(" "),s("form",{staticClass:"login-form"},[t._v("\n        用户名:"),s("br"),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.registerData.username,expression:"registerData.username"}],attrs:{type:"text",id:"adduser",name:"username"},domProps:{value:t.registerData.username},on:{input:function(i){i.target.composing||(t.registerData.username=i.target.value)}}}),s("br"),t._v("\n        密码:"),s("br"),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.registerData.password,expression:"registerData.password"}],attrs:{type:"password",id:"addpsd",name:"password"},domProps:{value:t.registerData.password},on:{input:function(i){i.target.composing||(t.registerData.password=i.target.value)}}}),s("br"),t._v("\n        确认密码:"),s("br"),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.registerData.confirmPassword,expression:"registerData.confirmPassword"}],attrs:{type:"password",id:"confirmPsd",name:"password"},domProps:{value:t.registerData.confirmPassword},on:{input:function(i){i.target.composing||(t.registerData.confirmPassword=i.target.value)}}}),s("br"),t._v(" "),s("input",{attrs:{type:"button",id:"registerSubmit",value:"注册"},on:{click:function(i){t.registerValidator()}}}),t._v(" "),s("input",{attrs:{type:"button",id:"tologin",value:"去登录"},on:{click:function(i){t.todo="login"}}})])])])])},staticRenderFns:[function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"title"},[s("h4",[t._v("登录")])])}]}}},[43]);
//# sourceMappingURL=app.abf6b16a36f6bfad0c38.js.map